<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${course.name} + ' | Color Run'">Infos Course | Color Run</title>
    <link rel="stylesheet" th:href="@{/css/style-liste-course.css}">
</head>
<body>
<div class="bg-circle1"></div>
<div class="bg-circle2"></div>
<div class="bg-circle3"></div>

<!-- Navbar (Ã  inclure en fragment si besoin) -->
<header class="navbar">
    <div class="logo">Color Run</div>
    <nav class="menu">
        <a th:href="@{/}" th:class="${activePage == 'home'} ? 'active' : ''">Accueil</a>
        <a th:href="@{/courses}" th:class="${activePage == 'courses'} ? 'active' : ''">Courses</a>
        <a th:href="@{/MyCourses}" th:class="${activePage == 'mycourses'} ? 'active' : ''">Mes courses</a>
        <a th:href="@{/agenda}" th:class="${activePage == 'agenda'} ? 'active' : ''">Agenda</a>
        <a th:href="@{/organizer/request}" th:class="${activePage == 'organizer'} ? 'active' : ''">Devenir Organisateur</a>
        <a href="#" class="account-icon" title="Mon compte" style="margin-left:24px;">
            <svg width="28" height="28" viewBox="0 0 28 28" fill="none" style="display:inline-block;vertical-align:middle;" xmlns="http://www.w3.org/2000/svg">
                <circle cx="14" cy="14" r="13" stroke="#6a82fb" stroke-width="2" fill="#fff"/>
                <circle cx="14" cy="11" r="5" fill="#e2e7ff" stroke="#6a82fb" stroke-width="1.5"/>
                <path d="M6 22c1.5-4 14.5-4 16 0" stroke="#6a82fb" stroke-width="1.5" fill="none" stroke-linecap="round"/>
            </svg>
        </a>
    </nav>
</header>

<!-- Hero Section pour la course -->
<section class="search-section">
    <section class="search-hero" style="display:flex; flex-direction:column; align-items:center; gap:32px;">
        <div style="display:flex; gap:32px; align-items:center; width:100%; justify-content:center;">
            <div style="width:220px; height:220px; background:#e2e7ff; border-radius:32px; background-image:url('images/course1.jpg'); background-size:cover; background-position:center;" th:style="'width:220px;height:220px;background:#e2e7ff;border-radius:32px;background-image:url('' + @{/images/} + ${course.image});background-size:cover;background-position:center;'"></div>
            <div style="flex:1; min-width:220px;">
                <h1 class="main-title" style="margin-bottom:12px;" th:text="${course.name}">Nom de la course</h1>
                <div style="font-size:1.2rem; color:#6a82fb; font-weight:600;" th:text="${course.city}">Lieu de la course</div>
                <div style="font-size:1.05rem; color:#ff6a88; font-weight:600; margin-top:8px;" th:text="${#dates.format(course.date, 'dd/MM/yyyy')}">Date de la course</div>
            </div>
        </div>
    </section>
</section>

<main class="main-container" style="margin-top:32px;">
    <div style="display:flex; gap:32px; align-items:flex-start; flex-wrap:wrap;">
        <!-- Colonne gauche : infos principales -->
        <div style="flex:2; min-width:340px;">
            <!-- En-tÃªte infos -->
            <section class="course-card" style="padding:32px 32px 24px 32px; margin-bottom:24px;">
                <div style="display:flex; gap:32px; align-items:flex-start;">
                    <div style="min-width:60px; text-align:center;">
                        <div style="font-size:2.2rem; font-weight:800; color:#ff6a88;" th:text="${#dates.format(course.date, 'd')}">8</div>
                        <div style="font-size:1rem; color:#666;" th:text="${#dates.format(course.date, 'E')}">Dim</div>
                    </div>
                    <div style="flex:1;">
                        <div style="font-size:1.1rem; font-weight:700; color:#6a82fb;" th:text="${#dates.format(course.date, 'EEEE d MMMM yyyy', 'fr')}">Dimanche 8 juin 2025</div>
                        <div style="font-size:1rem; color:#ff6a88; font-weight:600;" th:if="${course.finished}" th:text="'Course terminÃ©e'">Course terminÃ©e</div>
                        <div style="margin-top:8px; font-size:1rem; font-weight:600;" th:text="${course.city}">Huldenberg</div>
                        <div style="font-size:0.95rem; color:#6a82fb;" th:text="${course.region}">BE - Brabant Flamand</div>
                    </div>
                </div>
                <div style="margin-top:24px; color:#666; font-size:0.98rem;">
                    <div><b>Ouverture :</b> <span th:text="${#dates.format(course.openingDate, 'EEEE d MMMM yyyy Ã  HH:mm', 'fr')}">Samedi 7 juin 2025 Ã  00h00</span></div>
                    <div><b>Fermeture :</b> <span th:text="${#dates.format(course.closingDate, 'EEEE d MMMM yyyy Ã  HH:mm', 'fr')}">Samedi 7 juin 2025 Ã  20h00</span></div>
                </div>
                <!-- Prix principal et bouton paiement/participation -->
                <div style="margin-top:28px; display:flex; align-items:center; gap:24px;">
                    <span style="font-size:1.25rem; font-weight:700; color:#ff6a88;" th:text="${#numbers.formatDecimal(course.price, 1, 'COMMA', 2, 'POINT')} + ' â‚¬'">15,00 â‚¬</span>
                    <form th:action="@{/participate}" method="post" style="margin:0;">
                        <input type="hidden" name="courseId" th:value="${course.id}" />
                        <button type="submit" class="search-button" th:if="${isAuthenticated}" th:disabled="${course.finished}">Participer</button>
                        <span th:if="${!isAuthenticated}">Connectez-vous pour participer</span>
                    </form>
                </div>
            </section>
            <!-- Description -->
            <section class="course-card" style="padding:32px; margin-bottom:24px;">
                <div style="font-size:1.08rem; color:#222; margin-bottom:18px;" th:text="${course.description}">
                    Description de la course
                </div>
                <!-- Ajoute ici d'autres sections dynamiques si besoin -->
            </section>
            <!-- Liste des inscrits -->
            <section class="course-card" style="padding:24px; margin-bottom:24px;">
                <div style="font-weight:700; font-size:1.1rem; margin-bottom:12px;">Liste des inscrits</div>
                <div style="color:#666; margin-bottom:8px;" th:text="${participants.size()} + ' inscrit(s)'">0 inscrit(s)</div>
                <button id="show-participants" class="search-button secondary" style="min-width:100px; font-size:0.95rem; padding:6px 18px;">Voir la liste â†’</button>
            </section>
        </div>
    </div>
    <!-- Popup participants -->
    <div id="participants-popup" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.18); z-index:9999; align-items:center; justify-content:center;">
        <div style="background:#fff; border-radius:32px; max-width:500px; width:90%; margin:auto; box-shadow:0 8px 32px rgba(0,0,0,0.13); padding:32px 24px; position:relative;">
            <button onclick="document.getElementById('participants-popup').style.display='none'" style="position:absolute; top:18px; right:24px; background:none; border:none; font-size:1.5rem; color:#ff6a88; cursor:pointer;">Ã—</button>
            <h2 style="font-size:1.3rem; margin-bottom:18px; text-align:center;">Liste des participants</h2>
            <table style="width:100%; border-collapse:collapse; margin-bottom:0;">
                <thead>
                <tr style="background:#e2e7ff;">
                    <th style="padding:8px; border-radius:12px 0 0 12px;">Nom</th>
                    <th style="padding:8px;">PrÃ©nom</th>
                    <th style="padding:8px; border-radius:0 12px 12px 0;">Course</th>
                </tr>
                </thead>
                <tbody id="participants-list">
                <tr th:each="p : ${participants}">
                    <td style="padding:8px;" th:text="${p.lastName}">Dupont</td>
                    <td style="padding:8px;" th:text="${p.firstName}">Jean</td>
                    <td style="padding:8px;" th:text="${p.courseName}">10 km</td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
</main>

<!-- Footer -->
<footer class="footer">
    <div class="footer-content">
        <div class="newsletter">
            <p>Abonnez-vous Ã  notre newsletter</p>
            <form>
                <input type="email" placeholder="Votre email">
                <button type="submit">S'abonner</button>
            </form>
        </div>
        <div class="social-icons">
            <a href="#">ðŸ“¸ Instagram</a>
            <a href="#">ðŸ“˜ Facebook</a>
        </div>
        <div class="credits">
            <p>2025 Â© Color Run. Tous droits rÃ©servÃ©s.</p>
        </div>
    </div>
</footer>

<script th:inline="javascript">
    document.getElementById('show-participants').onclick = function() {
        document.getElementById('participants-popup').style.display = 'flex';
    };
</script>
</body>
</html> 